
@{
    ViewBag.Title = "ResetPassword";
    Layout = "~/Areas/Visitors/Views/Shared/_VisitorLayout.cshtml";
}

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-6">

            <div class="card shadow-lg border-0 rounded-3">
                <div class="card-body p-4">
                    <h3 class="text-center mb-4">Reset Password</h3>

                    <form id="resetPasswordForm">
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" id="email" name="email" class="form-control" placeholder="example@email.com" required />
                        </div>

                        <div class="mb-3">
                            <label for="otp" class="form-label">OTP Code</label>
                            <input type="text" id="otp" name="otp" class="form-control" placeholder="Enter OTP sent to your email" required />
                        </div>

                        <div class="mb-3">
                            <label for="newPassword" class="form-label">New Password</label>
                            <input type="password" id="newPassword" name="newPassword" class="form-control" placeholder="Enter new password" required />
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-success">Reset Password</button>
                        </div>
                    </form>

                    <div id="resetResultMessage" class="mt-3 text-center"></div>
                </div>
            </div>

        </div>
    </div>
</div>


@section Scripts {
    <script>
        $(document).ready(function () {
            $("#resetPasswordForm").submit(function (e) {
                e.preventDefault();

                $.ajax({
                    url: '@Url.Action("ResetPasswordUser", "Account", new { area = "Users" })',
                    type: 'POST',
                    data: {
                        email: $("#email").val(),
                        otp: $("#otp").val(),
                        newPassword: $("#newPassword").val()
                    },
                    success: function (response) {
                        if (response.success) {
                            $("#resetResultMessage").html(`<div class="alert alert-success">${response.message}</div>`);
                            $("#resetPasswordForm")[0].reset();

                            // redirect to login after 2 sec
                            setTimeout(function () {
                                window.location.href = '@Url.Action("Login", "Account", new { area = "Users" })';
                            }, 2000);

                        } else {
                            $("#resetResultMessage").html(`<div class="alert alert-danger">${response.message}</div>`);
                        }
                    },
                    error: function () {
                        $("#resetResultMessage").html(`<div class="alert alert-danger">Something went wrong. Try again later.</div>`);
                    }
                });
            });
        });
    </script>
}





@*@section Scripts {
        <script>
            $(document).ready(function () {
                $("#resetPasswordForm").submit(function (e) {
                    e.preventDefault();

                    $.ajax({
                        url: '@Url.Action("ResetPasswordUser", "Account", new { area = "Users" })',
                        type: 'POST',
                        data: {
                            email: $("#email").val(),
                            otp: $("#otp").val(),
                            newPassword: $("#newPassword").val()
                        },
                        success: function (response) {
                            if (response.success) {
                                $("#resetResultMessage").html(`<div class="alert alert-success">${response.message}</div>`);
                                $("#resetPasswordForm")[0].reset();
                            } else {
                                $("#resetResultMessage").html(`<div class="alert alert-danger">${response.message}</div>`);
                            }
                        },
                        error: function () {
                            $("#resetResultMessage").html(`<div class="alert alert-danger">Something went wrong. Try again later.</div>`);
                        }
                    });
                });
            });
        </script>
    }*@


